var LoadingUI=function(){function e(){this.div=document.getElementById("descCon")}var t=(__define,e),i=t.prototype;return i.OnInitLoadingView=function(e){this.max=e,this.cur=0,0==e?(this.div.innerHTML="正在加载:100%",this.CloseLoadingView()):this.div.innerHTML="正在加载:0%"},i.OnLoadFinished=function(){this.cur!=this.max&&(this.cur+1>=this.max?(this.div.innerHTML="正在加载:100%",this.CloseLoadingView()):(this.cur++,this.div.innerHTML="正在加载:"+Math.ceil(this.cur/this.max*100)+"%"))},i.CloseLoadingView=function(){this.div.innerHTML="正在加载:100%",window.setTimeout(function(){var e=document.getElementById("loadingCon");e.hidden=!0},1e3)},e}();egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.call(this),this.lights=new egret3d.LightGroup,this.loadingUI=new LoadingUI,this._egret3DCanvas=new egret3d.Egret3DCanvas,this._egret3DCanvas.x=0,this._egret3DCanvas.y=0,this._egret3DCanvas.width=window.innerWidth,this._egret3DCanvas.height=window.innerHeight,this._view3D=new egret3d.View3D(0,0,window.innerWidth,window.innerHeight),this._view3D.camera3D.lookAt(new egret3d.Vector3D(0,0,1e3),new egret3d.Vector3D(0,0,0)),this._view3D.backColor=4294967295,this._egret3DCanvas.addView3D(this._view3D);var t=new egret3d.DirectLight(new egret3d.Vector3D(.3,-.3,.1));t.diffuse=16777215,this.lights.addLight(t);var i=new egret3d.URLLoader;i.addEventListener(egret3d.LoaderEvent3D.LOADER_COMPLETE,this.onLoad,this),i.load("resource/LingTong/Bonezero.esm"),this.InitCameraCtl(),this._egret3DCanvas.start(),this._egret3DCanvas.addEventListener(egret3d.Event3D.ENTER_FRAME,this.update,this),this.loadingUI.OnInitLoadingView(3),egret3d.Input.addEventListener(egret3d.Event3D.RESIZE,this.OnWindowResize,this)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.update=function(e){this.cameraCtl.update()},n.OnWindowResize=function(e){this._egret3DCanvas.width=window.innerWidth,this._egret3DCanvas.height=window.innerHeight,this._view3D.width=window.innerWidth,this._view3D.height=window.innerHeight},n.InitCameraCtl=function(){this.cameraCtl=new egret3d.LookAtController(this._view3D.camera3D,new egret3d.Object3D),this.cameraCtl.distance=300,this.cameraCtl.rotationX=0},n.onLoad=function(e){this.loadingUI.OnLoadFinished();var t=new egret3d.TextureMaterial,i=e.loader.data;this.model=new egret3d.Mesh(i,t),this.model.material.lightGroup=this.lights,this.model.y=-100,this._view3D.addChild3D(this.model);var n=new egret3d.URLLoader;n.addEventListener(egret3d.LoaderEvent3D.LOADER_COMPLETE,this.onLoadTexture,this),n.load("resource/LingTong/hero_12.png"),n.mat=t;var a=new egret3d.URLLoader;a.addEventListener(egret3d.LoaderEvent3D.LOADER_COMPLETE,this.onAnimationIdle,this),a.load("resource/LingTong/Idle.eam")},n.onLoadTexture=function(e){this.loadingUI.OnLoadFinished(),e.loader.mat.diffuseTexture=e.loader.data,e.loader.removeEventListener(egret3d.LoaderEvent3D.LOADER_COMPLETE,this.onLoadTexture,this)},n.onAnimationIdle=function(e){this.loadingUI.OnLoadFinished(),this.idle=e.loader.data,this.idle.animationName="idle",this.model.animation.skeletonAnimationController.addSkeletonAnimationClip(this.idle),this.model.animation.skeletonAnimationController.play(this.idle.animationName),this.model.removeEventListener(egret3d.LoaderEvent3D.LOADER_COMPLETE,this.onAnimationIdle,this)},t}(egret.DisplayObject);egret.registerClass(Main,"Main");